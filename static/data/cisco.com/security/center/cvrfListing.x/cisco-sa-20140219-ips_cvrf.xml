<?xml version="1.0"?><cvrfdoc xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1"><DocumentTitle>Multiple Vulnerabilities in Cisco IPS Software</DocumentTitle><DocumentType>Cisco Security Advisory</DocumentType><DocumentPublisher Type="Vendor"><ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</ContactDetails><IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</IssuingAuthority></DocumentPublisher><DocumentTracking><Identification><ID>cisco-sa-20140219-ips</ID></Identification><Status>Final</Status><Version>1.0</Version><RevisionHistory><Revision><Number>1.0</Number><Date>2014-02-19T15:51:20</Date><Description>Initial public release</Description></Revision></RevisionHistory><InitialReleaseDate>2014-02-19T16:00:00</InitialReleaseDate><CurrentReleaseDate>2014-02-19T15:51:20</CurrentReleaseDate><Generator><Engine>TVCE</Engine></Generator></DocumentTracking><DocumentNotes><Note Title="Summary" Type="General" Ordinal="1">Cisco Intrusion Prevention System (IPS) Software is affected by the following vulnerabilities:



    Cisco IPS Analysis Engine Denial of Service Vulnerability
    Cisco IPS Control-Plane MainApp Denial of Service Vulnerability 
    Cisco IPS Jumbo Frame Denial of Service Vulnerability 

The Cisco IPS Analysis Engine Denial of Service Vulnerability and the Cisco IPS Jumbo Frame Denial of Service Vulnerability could allow an unauthenticated, remote attacker to cause the Analysis Engine process to become unresponsive or crash. When this occurs, the Cisco IPS will stop inspecting traffic.



The Cisco IPS Control-Plane MainApp Denial of Service Vulnerability could allow an unauthenticated, remote attacker to cause the MainApp process to become unresponsive and prevent it from executing several tasks including alert
notification, event store management, and sensor authentication. The
Cisco IPS web server will also be unavailable while the MainApp process is unresponsive, and other processes such as the Analysis Engine process may not work properly.

 


Cisco has released free software updates that address these vulnerabilities. Workarounds that mitigate some of the vulnerabilities are available.
This advisory is available at the following link:

http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips["http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips"]</Note><Note Title="Status of this Notice" Type="General" Ordinal="2">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or Paraphrase of the text of this document that omits the distribution URL in the following section is an uncontrolled copy, and may lack important information or contain factual errors.
</Note></DocumentNotes><DocumentDistribution>This advisory is posted on Cisco Security at the following link:

http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips["http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips"]

Additionally, a text version of this advisory is clear signed with the Cisco PSIRT PGP key and circulated among the following e-mail addresses: 


    cust-security-announce@cisco.com 
    first-bulletins@lists.first.org 
    bugtraq@securityfocus.com 
    vulnwatch@vulnwatch.org 
    cisco@spot.colorado.edu 
    cisco-nsp@puck.nether.net 
    full-disclosure@lists.grok.org.uk 

Future updates of this advisory, if any, will reside on Cisco.com but may not be announced on mailing lists. Users can monitor this advisory's URL for any updates.
</DocumentDistribution><DocumentReferences><Reference Type="Self"><URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips</URL><Description>Multiple Vulnerabilities in Cisco IPS Software</Description></Reference><Reference><URL>http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605</URL><Description>Mitigation and Identification of Multiple Vulnerabilities in Cisco IPS Software</Description></Reference></DocumentReferences><ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1"><FullProductName ProductID="CVRFPID-79296">Cisco Intrusion Prevention System (IPS) 6.1 Base</FullProductName><FullProductName ProductID="CVRFPID-189702">Cisco Intrusion Prevention System (IPS) 7.0 Base</FullProductName><FullProductName ProductID="CVRFPID-197621">Cisco Intrusion Prevention System (IPS) 7.0(1)E3</FullProductName><FullProductName ProductID="CVRFPID-197622">Cisco Intrusion Prevention System (IPS) 7.0(2)E3</FullProductName><FullProductName ProductID="CVRFPID-197623">Cisco Intrusion Prevention System (IPS) 7.0(2)E4</FullProductName><FullProductName ProductID="CVRFPID-197624">Cisco Intrusion Prevention System (IPS) 7.0(4)E4</FullProductName><FullProductName ProductID="CVRFPID-197625">Cisco Intrusion Prevention System (IPS) 7.0(6)E4</FullProductName><FullProductName ProductID="CVRFPID-197626">Cisco Intrusion Prevention System (IPS) 7.0(7)E4</FullProductName><FullProductName ProductID="CVRFPID-197627">Cisco Intrusion Prevention System (IPS) 7.0(8)E4</FullProductName><FullProductName ProductID="CVRFPID-197628">Cisco Intrusion Prevention System (IPS) 7.0(9)E4</FullProductName><FullProductName ProductID="CVRFPID-189704">Cisco Intrusion Prevention System (IPS) 7.1 Base</FullProductName><FullProductName ProductID="CVRFPID-197611">Cisco Intrusion Prevention System (IPS) 7.1(1)E4</FullProductName><FullProductName ProductID="CVRFPID-197612">Cisco Intrusion Prevention System (IPS) 7.1(2)E4</FullProductName><FullProductName ProductID="CVRFPID-197613">Cisco Intrusion Prevention System (IPS) 7.1(3)E4</FullProductName><FullProductName ProductID="CVRFPID-197614">Cisco Intrusion Prevention System (IPS) 7.1(4)E4</FullProductName><FullProductName ProductID="CVRFPID-197615">Cisco Intrusion Prevention System (IPS) 7.1(5)E4</FullProductName><FullProductName ProductID="CVRFPID-197616">Cisco Intrusion Prevention System (IPS) 7.1(6)E4</FullProductName><FullProductName ProductID="CVRFPID-197617">Cisco Intrusion Prevention System (IPS) 7.1(7)E4</FullProductName><FullProductName ProductID="CVRFPID-197618">Cisco Intrusion Prevention System (IPS) 7.1(8)E4</FullProductName><FullProductName ProductID="CVRFPID-197620">Cisco Intrusion Prevention System (IPS) 7.2 Base</FullProductName></ProductTree><Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1"><Title>Cisco IPS Analysis Engine Denial of Service Vulnerability</Title><ID SystemName="Cisco Bug ID">CSCui91266</ID><Notes><Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the produce-verbose-alert code of Cisco Intrusion
Prevention System (IPS) Software could allow an unauthenticated, remote
attacker to cause the Analysis Engine process to become unresponsive.



The
vulnerability is due to improper handling of fragmented packets by the
Analysis Engine process when the produce-verbose-alert action is enabled. An
attacker could exploit this vulnerability by sending fragmented packets
through the affected system. To trigger the vulnerability, the
attacker could cause a signature with the produce-verbose-alert action to
fire, or trigger an event for which produce-verbose-alert has been configured as an event action override. An exploit could allow the attacker to cause the Analysis Engine process
to become unresponsive. This will cause the affected system to stop inspecting
traffic.</Note></Notes><CVE>CVE-2014-0718</CVE><ProductStatuses><Status Type="Known Affected"><ProductID>CVRFPID-197614</ProductID><ProductID>CVRFPID-197615</ProductID><ProductID>CVRFPID-197616</ProductID><ProductID>CVRFPID-197617</ProductID><ProductID>CVRFPID-197618</ProductID><ProductID>CVRFPID-197620</ProductID></Status></ProductStatuses><Threats><Threat Type="Impact"><Description>Successful exploitation of the Cisco IPS Analysis Engine Denial of Service Vulnerability and the Cisco IPS Jumbo Frame Denial of Service Vulnerability may cause the Analysis Engine process to become unresponsive. When this occurs, the Cisco IPS will stop inspecting traffic.



Successful exploitation of the Cisco IPS Control-Plane MainApp Denial of Service Vulnerability may cause the MainApp process to become unresponsive and prevent it from executing several tasks including alert
notification, event store management, and sensor authentication. The
Cisco IPS web server will also be unavailable while the MainApp process is unresponsive, and other processes such as the Analysis Engine process may not work properly.



If the Cisco IPS is configured in promiscuous mode, mitigation actions that require MainApp processing, such as shun or rate-limit,
may be unavailable. If the Cisco IPS is configured in inline mode, the sensor may not
correctly perform inspection and mitigation actions because the Analysis Engine process may not work properly. A reload is required to restore the full functionality of the affected system.



Additionally, if the Cisco ASA with a Cisco IPS module
running an affected version of software is configured in High Availability (HA) mode, a
fail-over event may be triggered when the MainApp becomes unresponsive.
</Description></Threat></Threats><CVSSScoreSets><ScoreSet><BaseScore>7.1</BaseScore><TemporalScore>5.9</TemporalScore><Vector>AV:N/AC:M/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C/</Vector></ScoreSet></CVSSScoreSets><Remediations><Remediation Type="Workaround"><Description>To work around the Cisco IPS Analysis Engine Denial of Service Vulnerability administrator can disable the produce-verbose-alert action.



Use show configuration command to determine which signature has the produce-verbose-alert option enabled or wheter the produce-verbose-alert option is enabled as EAO.



If the produce-verbose-alert has been configured at the signature level, the value can be modified by entering the signature configuration prompt and modifying the event action for each signature that needs modification to use produce-alert instead of the produce-verbose-alert action. The following example shows the procedure to change the event action from produce-verbose-alert to produce-alert for signature 1475/0:




sensor(config)# service signature-definition sig0
sensor(config-sig)# signatures 1475 0 
sensor(config-sig-sig)# engine string-tcp 
sensor(config-sig-sig-str)# event-action produce-alert
sensor(config-sig-sig-str)# exit
sensor(config-sig-sig)# exit
sensor(config-sig)# exit
Apply Changes?[yes]: yes
sensor(config)#



Alternatively, an administrator can use the Cisco Intrusion Prevention System Device Manager (IDM) to
connect to the Cisco IPS and navigate to Configuration &gt; Policies
&gt; Signature Definitions &gt;  -Sig-Definition-Name- &gt; Active
Signatures and filter by using Filter: Action Produce Verbose Alert in order to verify any active signatures with the produce-verbose-alert option enabled.



For each of the signatures, right-click and choose Edit Action. From the panel, uncheck the Produce Verbose Alert check box, click the OK and apply the changes.



If the produce-verbose-alert action is enabled as EAO, this can be disable by modifying the settings for the event action rules policy.



The following example shows how to disable the override with produce-verbose-alert configured in the rules0 event action rules policy:




sensor(config)# service event-action-rules rules0
sensor(config-eve)# no overrides produce-verbose-alert 
sensor(config-eve)# exit
Apply Changes?[yes]: yes
sensor(config)# 





There is no workaround for the Cisco IPS Control-Plane MainApp Denial of Service Vulnerability , however restricting the number of allowed hosts may reduce the exposure of this vulnerability.



To restrict the number of allowed hosts, the administrator should use the access-list command. The no access-list command should be used to remove any hosts or networks from the list.

The following example shows the sequence of commands to remove
access to the full 192.168.1.0/24 network and allow access only to the
host with IP address 192.168.1.1:

    Use the show settings command in
    network-setting configuration mode to see the current allowed hosts or
    networks. The following example shows that the Cisco IDSM-2 is
    configured to allow all the hosts in the 192.168.1.0/24 network:


sensor(config-hos-net)# show settings
   network-settings
   -----------------------------------------------
      [...]
      access-list (min: 0, max: 512, current: 1)
      -----------------------------------------------
         network-address: 192.168.1.0/24
         -----------------------------------------------
      -----------------------------------------------
      ftp-timeout: 300 seconds 
      login-banner-text: 
      [...]


    Use the access-list command in network-setting
    configuration mode to add the 192.168.1.1 hosts.

Note: make sure that if this
is the only allowed host, it is also the one from which you are
executing the configuration commands to avoid losing connectivity to the Cisco
IDSM-2 Module.

sensor(config-hos-net)#access-list 192.168.1.1/32


    Use the no access-list command in network-setting configuration mode to remove the 192.168.1.0/32 network for the allowed hosts list:


sensor(config-hos-net)#no access-list 192.168.1.0/24


    Use the show settings command in network-setting configuration mode to check that the list of allowed hosts is correct:


sensor(config-hos-net)# show settings
   network-settings
   -----------------------------------------------
      [...]
      access-list (min: 0, max: 512, current: 1)
      -----------------------------------------------
         network-address: 192.168.1.1/32
         -----------------------------------------------
      -----------------------------------------------
      ftp-timeout: 300 seconds 
      login-banner-text: 
      [...]


    Exit and apply the configuration:


sensor(config-hos-net)# exit
sensor(config-hos)# exit
Apply Changes:?[yes]: 


There is no workaround for the Cisco IPS Jumbo Frame Denial of Service Vulnerability.





Additional mitigations that can be deployed on Cisco devices within the
network are available in the Cisco Applied Intelligence companion
document for this Advisory: http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605 ["http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605"]
</Description></Remediation></Remediations><References><Reference Type="Self"><URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips</URL><Description>Multiple Vulnerabilities in Cisco IPS Software</Description></Reference></References></Vulnerability><Vulnerability Ordinal="2" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1"><Title>Cisco IPS Control-Plane MainApp Denial of Service Vulnerability</Title><ID SystemName="Cisco Bug ID">CSCui67394</ID><Notes><Note Title="Summary" Type="Summary" Ordinal="2">A vulnerability in the implementation of the control-plane access list
of the Cisco IPS Software could allow an unauthenticated, remote
attacker to cause the MainApp process to become unresponsive.



The
vulnerability is due to a failure to properly handle malformed TCP packets sent to the
management IP address of the affected system. An attacker could exploit
this vulnerability by sending crafted TCP packets to TCP port 7000 of the IP address of the management interface.
An exploit could allow the attacker to make the MainApp process
unresponsive. This creates a denial of service (DoS) condition because
the Cisco IPS sensor is not able to execute several critical tasks
including alert notification, event store management, and sensor
authentication. The Cisco IPS web server will also be unavailable while
the MainApp process is unresponsive. Additionally, due to this general
system failure, other processes such as the Analysis Engine may not work
properly.</Note></Notes><CVE>CVE-2014-0719</CVE><ProductStatuses><Status Type="Known Affected"><ProductID>CVRFPID-79296</ProductID><ProductID>CVRFPID-189702</ProductID><ProductID>CVRFPID-189704</ProductID><ProductID>CVRFPID-197611</ProductID><ProductID>CVRFPID-197612</ProductID><ProductID>CVRFPID-197613</ProductID><ProductID>CVRFPID-197614</ProductID><ProductID>CVRFPID-197615</ProductID><ProductID>CVRFPID-197616</ProductID><ProductID>CVRFPID-197617</ProductID><ProductID>CVRFPID-197618</ProductID><ProductID>CVRFPID-197620</ProductID><ProductID>CVRFPID-197621</ProductID><ProductID>CVRFPID-197622</ProductID><ProductID>CVRFPID-197623</ProductID><ProductID>CVRFPID-197624</ProductID><ProductID>CVRFPID-197625</ProductID><ProductID>CVRFPID-197626</ProductID><ProductID>CVRFPID-197627</ProductID><ProductID>CVRFPID-197628</ProductID></Status></ProductStatuses><Threats><Threat Type="Impact"><Description>Successful exploitation of the Cisco IPS Analysis Engine Denial of Service Vulnerability and the Cisco IPS Jumbo Frame Denial of Service Vulnerability may cause the Analysis Engine process to become unresponsive. When this occurs, the Cisco IPS will stop inspecting traffic.



Successful exploitation of the Cisco IPS Control-Plane MainApp Denial of Service Vulnerability may cause the MainApp process to become unresponsive and prevent it from executing several tasks including alert
notification, event store management, and sensor authentication. The
Cisco IPS web server will also be unavailable while the MainApp process is unresponsive, and other processes such as the Analysis Engine process may not work properly.



If the Cisco IPS is configured in promiscuous mode, mitigation actions that require MainApp processing, such as shun or rate-limit,
may be unavailable. If the Cisco IPS is configured in inline mode, the sensor may not
correctly perform inspection and mitigation actions because the Analysis Engine process may not work properly. A reload is required to restore the full functionality of the affected system.



Additionally, if the Cisco ASA with a Cisco IPS module
running an affected version of software is configured in High Availability (HA) mode, a
fail-over event may be triggered when the MainApp becomes unresponsive.
</Description></Threat></Threats><CVSSScoreSets><ScoreSet><BaseScore>7.8</BaseScore><TemporalScore>6.8</TemporalScore><Vector>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C/</Vector></ScoreSet></CVSSScoreSets><Remediations><Remediation Type="Workaround"><Description>To work around the Cisco IPS Analysis Engine Denial of Service Vulnerability administrator can disable the produce-verbose-alert action.



Use show configuration command to determine which signature has the produce-verbose-alert option enabled or wheter the produce-verbose-alert option is enabled as EAO.



If the produce-verbose-alert has been configured at the signature level, the value can be modified by entering the signature configuration prompt and modifying the event action for each signature that needs modification to use produce-alert instead of the produce-verbose-alert action. The following example shows the procedure to change the event action from produce-verbose-alert to produce-alert for signature 1475/0:




sensor(config)# service signature-definition sig0
sensor(config-sig)# signatures 1475 0 
sensor(config-sig-sig)# engine string-tcp 
sensor(config-sig-sig-str)# event-action produce-alert
sensor(config-sig-sig-str)# exit
sensor(config-sig-sig)# exit
sensor(config-sig)# exit
Apply Changes?[yes]: yes
sensor(config)#



Alternatively, an administrator can use the Cisco Intrusion Prevention System Device Manager (IDM) to
connect to the Cisco IPS and navigate to Configuration &gt; Policies
&gt; Signature Definitions &gt;  -Sig-Definition-Name- &gt; Active
Signatures and filter by using Filter: Action Produce Verbose Alert in order to verify any active signatures with the produce-verbose-alert option enabled.



For each of the signatures, right-click and choose Edit Action. From the panel, uncheck the Produce Verbose Alert check box, click the OK and apply the changes.



If the produce-verbose-alert action is enabled as EAO, this can be disable by modifying the settings for the event action rules policy.



The following example shows how to disable the override with produce-verbose-alert configured in the rules0 event action rules policy:




sensor(config)# service event-action-rules rules0
sensor(config-eve)# no overrides produce-verbose-alert 
sensor(config-eve)# exit
Apply Changes?[yes]: yes
sensor(config)# 





There is no workaround for the Cisco IPS Control-Plane MainApp Denial of Service Vulnerability , however restricting the number of allowed hosts may reduce the exposure of this vulnerability.



To restrict the number of allowed hosts, the administrator should use the access-list command. The no access-list command should be used to remove any hosts or networks from the list.

The following example shows the sequence of commands to remove
access to the full 192.168.1.0/24 network and allow access only to the
host with IP address 192.168.1.1:

    Use the show settings command in
    network-setting configuration mode to see the current allowed hosts or
    networks. The following example shows that the Cisco IDSM-2 is
    configured to allow all the hosts in the 192.168.1.0/24 network:


sensor(config-hos-net)# show settings
   network-settings
   -----------------------------------------------
      [...]
      access-list (min: 0, max: 512, current: 1)
      -----------------------------------------------
         network-address: 192.168.1.0/24
         -----------------------------------------------
      -----------------------------------------------
      ftp-timeout: 300 seconds 
      login-banner-text: 
      [...]


    Use the access-list command in network-setting
    configuration mode to add the 192.168.1.1 hosts.

Note: make sure that if this
is the only allowed host, it is also the one from which you are
executing the configuration commands to avoid losing connectivity to the Cisco
IDSM-2 Module.

sensor(config-hos-net)#access-list 192.168.1.1/32


    Use the no access-list command in network-setting configuration mode to remove the 192.168.1.0/32 network for the allowed hosts list:


sensor(config-hos-net)#no access-list 192.168.1.0/24


    Use the show settings command in network-setting configuration mode to check that the list of allowed hosts is correct:


sensor(config-hos-net)# show settings
   network-settings
   -----------------------------------------------
      [...]
      access-list (min: 0, max: 512, current: 1)
      -----------------------------------------------
         network-address: 192.168.1.1/32
         -----------------------------------------------
      -----------------------------------------------
      ftp-timeout: 300 seconds 
      login-banner-text: 
      [...]


    Exit and apply the configuration:


sensor(config-hos-net)# exit
sensor(config-hos)# exit
Apply Changes:?[yes]: 


There is no workaround for the Cisco IPS Jumbo Frame Denial of Service Vulnerability.





Additional mitigations that can be deployed on Cisco devices within the
network are available in the Cisco Applied Intelligence companion
document for this Advisory: http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605 ["http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605"]
</Description></Remediation></Remediations><References><Reference Type="Self"><URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips</URL><Description>Multiple Vulnerabilities in Cisco IPS Software</Description></Reference></References></Vulnerability><Vulnerability Ordinal="3" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1"><Title>Cisco IPS Jumbo Frame Denial of Service Vulnerability</Title><ID SystemName="Cisco Bug ID">CSCuh94944</ID><Notes><Note Title="Summary" Type="Summary" Ordinal="3">A vulnerability in Cisco IPS code that handles jumbo frames  could allow an
unauthenticated, remote attacker to cause the Analysis Engine process
to become unresponsive.



The vulnerability is due to improper
handling of jumbo frames sent a high rate. An attacker could exploit
this vulnerability by sending jumbo frames through the sensing interface
of the affected device. An exploit could allow the attacker to cause the Analysis Engine process
to become unresponsive. This will cause the affected system to stop inspecting
traffic.</Note></Notes><CVE>CVE-2014-0720</CVE><ProductStatuses><Status Type="Known Affected"><ProductID>CVRFPID-189704</ProductID><ProductID>CVRFPID-197611</ProductID><ProductID>CVRFPID-197612</ProductID><ProductID>CVRFPID-197613</ProductID><ProductID>CVRFPID-197614</ProductID><ProductID>CVRFPID-197615</ProductID><ProductID>CVRFPID-197616</ProductID><ProductID>CVRFPID-197617</ProductID><ProductID>CVRFPID-197618</ProductID><ProductID>CVRFPID-197620</ProductID></Status></ProductStatuses><Threats><Threat Type="Impact"><Description>Successful exploitation of the Cisco IPS Analysis Engine Denial of Service Vulnerability and the Cisco IPS Jumbo Frame Denial of Service Vulnerability may cause the Analysis Engine process to become unresponsive. When this occurs, the Cisco IPS will stop inspecting traffic.



Successful exploitation of the Cisco IPS Control-Plane MainApp Denial of Service Vulnerability may cause the MainApp process to become unresponsive and prevent it from executing several tasks including alert
notification, event store management, and sensor authentication. The
Cisco IPS web server will also be unavailable while the MainApp process is unresponsive, and other processes such as the Analysis Engine process may not work properly.



If the Cisco IPS is configured in promiscuous mode, mitigation actions that require MainApp processing, such as shun or rate-limit,
may be unavailable. If the Cisco IPS is configured in inline mode, the sensor may not
correctly perform inspection and mitigation actions because the Analysis Engine process may not work properly. A reload is required to restore the full functionality of the affected system.



Additionally, if the Cisco ASA with a Cisco IPS module
running an affected version of software is configured in High Availability (HA) mode, a
fail-over event may be triggered when the MainApp becomes unresponsive.
</Description></Threat></Threats><CVSSScoreSets><ScoreSet><BaseScore>7.1</BaseScore><TemporalScore>5.9</TemporalScore><Vector>AV:N/AC:M/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C/</Vector></ScoreSet></CVSSScoreSets><Remediations><Remediation Type="Workaround"><Description>To work around the Cisco IPS Analysis Engine Denial of Service Vulnerability administrator can disable the produce-verbose-alert action.



Use show configuration command to determine which signature has the produce-verbose-alert option enabled or wheter the produce-verbose-alert option is enabled as EAO.



If the produce-verbose-alert has been configured at the signature level, the value can be modified by entering the signature configuration prompt and modifying the event action for each signature that needs modification to use produce-alert instead of the produce-verbose-alert action. The following example shows the procedure to change the event action from produce-verbose-alert to produce-alert for signature 1475/0:




sensor(config)# service signature-definition sig0
sensor(config-sig)# signatures 1475 0 
sensor(config-sig-sig)# engine string-tcp 
sensor(config-sig-sig-str)# event-action produce-alert
sensor(config-sig-sig-str)# exit
sensor(config-sig-sig)# exit
sensor(config-sig)# exit
Apply Changes?[yes]: yes
sensor(config)#



Alternatively, an administrator can use the Cisco Intrusion Prevention System Device Manager (IDM) to
connect to the Cisco IPS and navigate to Configuration &gt; Policies
&gt; Signature Definitions &gt;  -Sig-Definition-Name- &gt; Active
Signatures and filter by using Filter: Action Produce Verbose Alert in order to verify any active signatures with the produce-verbose-alert option enabled.



For each of the signatures, right-click and choose Edit Action. From the panel, uncheck the Produce Verbose Alert check box, click the OK and apply the changes.



If the produce-verbose-alert action is enabled as EAO, this can be disable by modifying the settings for the event action rules policy.



The following example shows how to disable the override with produce-verbose-alert configured in the rules0 event action rules policy:




sensor(config)# service event-action-rules rules0
sensor(config-eve)# no overrides produce-verbose-alert 
sensor(config-eve)# exit
Apply Changes?[yes]: yes
sensor(config)# 





There is no workaround for the Cisco IPS Control-Plane MainApp Denial of Service Vulnerability , however restricting the number of allowed hosts may reduce the exposure of this vulnerability.



To restrict the number of allowed hosts, the administrator should use the access-list command. The no access-list command should be used to remove any hosts or networks from the list.

The following example shows the sequence of commands to remove
access to the full 192.168.1.0/24 network and allow access only to the
host with IP address 192.168.1.1:

    Use the show settings command in
    network-setting configuration mode to see the current allowed hosts or
    networks. The following example shows that the Cisco IDSM-2 is
    configured to allow all the hosts in the 192.168.1.0/24 network:


sensor(config-hos-net)# show settings
   network-settings
   -----------------------------------------------
      [...]
      access-list (min: 0, max: 512, current: 1)
      -----------------------------------------------
         network-address: 192.168.1.0/24
         -----------------------------------------------
      -----------------------------------------------
      ftp-timeout: 300 seconds 
      login-banner-text: 
      [...]


    Use the access-list command in network-setting
    configuration mode to add the 192.168.1.1 hosts.

Note: make sure that if this
is the only allowed host, it is also the one from which you are
executing the configuration commands to avoid losing connectivity to the Cisco
IDSM-2 Module.

sensor(config-hos-net)#access-list 192.168.1.1/32


    Use the no access-list command in network-setting configuration mode to remove the 192.168.1.0/32 network for the allowed hosts list:


sensor(config-hos-net)#no access-list 192.168.1.0/24


    Use the show settings command in network-setting configuration mode to check that the list of allowed hosts is correct:


sensor(config-hos-net)# show settings
   network-settings
   -----------------------------------------------
      [...]
      access-list (min: 0, max: 512, current: 1)
      -----------------------------------------------
         network-address: 192.168.1.1/32
         -----------------------------------------------
      -----------------------------------------------
      ftp-timeout: 300 seconds 
      login-banner-text: 
      [...]


    Exit and apply the configuration:


sensor(config-hos-net)# exit
sensor(config-hos)# exit
Apply Changes:?[yes]: 


There is no workaround for the Cisco IPS Jumbo Frame Denial of Service Vulnerability.





Additional mitigations that can be deployed on Cisco devices within the
network are available in the Cisco Applied Intelligence companion
document for this Advisory: http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605 ["http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32605"]
</Description></Remediation></Remediations><References><Reference Type="Self"><URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-ips</URL><Description>Multiple Vulnerabilities in Cisco IPS Software</Description></Reference></References></Vulnerability></cvrfdoc>